<!-- post template -->
<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="utf-8">
   <title>Alex Le's Blog</title>

   <!-- stylesheets -->
   <link rel="stylesheet" href="/css/index.css" type="text/css">

   <!-- javascript -->
   <script src="js/jquery-1.3.2.min.js"></script>
</head>

<body>
   <div id="wrapper">
      
         <div id="leftcol">
            
            <a href="/">
               <img src="/static/alex_vegas_headshot_seph_round.jpg" height="80px" width="80px" style="margin-bottom: 0px; margin-right: 10px; float: left;">
            </a>
            Hi, I'm <a href="/">Alex Le</a>. I live in Thornton, write firmware for disc drives, and try to learn something new every day.
            I like riding motorcycles, The Killers, working out, and a few other things.<br /><br />
            This is a place for my thoughts, goals, and interesting topics I come across.
            <br clear='all' /> 
         </div>

         <div id="rightcol">
            
   <div class="entry">
      <div class="post_title">
         <h2>How to scrape a web page with python (Criminal Minds)</h2>
         <p>Sep 27, 2011</p>
      </div>

      <p>I've been hooked on the television show Criminal Minds lately. It follows a team of FBI profilers who analyze criminal behavior to catch some twisted bad guys. It's intriguing to me why serial killers do what they do, so the study and breakdown of each criminal's psyche in the show is appealing.</p>
<p>Luckily for me, ION airs 1-4 episodes almost every day. The only problem is I can never remember what time the show is on. As a result, I have to go to the ION website and check what time the episodes are. Every day.</p>
<p>I got tired of this rather quickly and wrote a python script to "scrape" the webpage for show times. Web scraping is a technique to extract information from websites using code. There are many different ways to scrape the web; the method I used is crude but simple:</p>
<h1>!/usr/bin/python</h1>
<p>from urllib import urlopen
import re, time</p>
<p>LINK = 'http://www.ionline.tv' # url to scrape
SHOW = 'CRIMINAL MINDS' # show keyword to search on
msg = SHOW
show_index = 0</p>
<p>content = urlopen( LINK ).read()</p>
<p>dates_array = re.findall( 'weekdate"&gt;(.*?)&lt;', content )</p>
<p>time = re.findall( 'title"&gt;(.<em>?)&lt;.</em>?eastern"&gt;(.<em>?)&lt;.</em>?(/ul|&lt;li)', content )</p>
<p>for date_entry in range( len(dates_array) - 1 ):</p>
<p>msg += '\n' + dates_array[date_entry] # iterate through dates</p>
<p>while True:
    if ( time[show_index][0] == SHOW ): # check if show is CM
      msg += '\n' + time[show_index][1]</p>
<pre><code>show_index += 1

if ( time[show_index-1][2] == '/ul' ): # marker for end of day
  break
</code></pre>
<p>print msg
The procedure involves 3 steps: 
Read in the site's data. This is done with urlopen( LINK ).read().
Parse the data I want (date/time) using regular expressions with re.findall().
Run a loop to check/print matches for my show.
As of 9/27/11, running the script above produces an output of:
CRIMINAL MINDS
September 27
9
10
11
September 28
10
11
September 29
8
9
10
11
September 30
October 1
October 2
October 3
9
10
11
Time and date of every Criminal Mind episode for the next week. Fist pump!</p>
<p>However, there is a downside to the script above (and web scraping in general). If the site redesigns its web page, or changes its data, there's a high probability the script/regex will be affected. For that reason, it is always preferred to use a site's API if available.</p>
   </div>

         </div>
      

      <div id="footer">
         
      </div>
   </div>
</body>
</html>