<!-- htmlhint tag-pair:false -->
{% comment %}
Code Snippet Shortcode
Usage:
{% include shortcodes/code.html
  language="javascript"
  title="example.js"
  code="const hello = 'world';
console.log(hello);"
%}

The code parameter is required. All others are optional.
{% endcomment %}

<div class="code-snippet">
  <div class="code-snippet-header">
    {% if include.title %}<span>{{ include.title }}</span>{% endif %}
    <button class="copy-button" onclick="copyCode(this)">Copy</button>
  </div>
  <div class="highlight">
    <pre class="highlight{% if include.language %} language-{{ include.language }}{% else %} language-plaintext{% endif %}"><code>{{ include.code }}</code></pre>
  </div>
</div>

<script>
  function copyCode(button) {
    const preElement = button.parentElement.nextElementSibling.querySelector('pre');
    const codeElement = preElement.querySelector('code');

    const textToCopy = codeElement.innerText;

    navigator.clipboard.writeText(textToCopy).then(
      function() {
        // Success
        const originalText = button.innerText;
        button.innerText = 'Copied!';
        setTimeout(() => {
          button.innerText = originalText;
        }, 2000);
      },
      function() {
        // Failure
        button.innerText = 'Failed!';
        setTimeout(() => {
          button.innerText = 'Copy';
        }, 2000);
      }
    );
  }
</script>
<!-- htmlhint tag-pair:true -->